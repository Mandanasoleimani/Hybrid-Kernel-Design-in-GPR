function K_ff = k_ff(xx, yy, hyp,i)
global ModelInfo
zeta=ModelInfo.zeta;
logsigma = hyp(1);
logthetat = hyp(2);
logthetax = hyp(3);
alpha = hyp(4);

t = xx(:,1);
x = xx(:,2);
s = yy(:,1);
y = yy(:,2);

if i == 0 || i == 1
    
    K_ff = exp(logsigma) .* (0.10e1 ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.100e1 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .^ 2 + zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.3e1 ./ 0.2e1) ./ exp(logthetat)) - alpha .* exp(logsigma) .* (0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.1000e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.15e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) + 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) - alpha .* (exp(logsigma) .* (-0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.1000e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.15e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) - 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) - alpha .* exp(logsigma) .* (0.300e1 ./ exp(logthetax) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.6000e1 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,x,y') .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.10000e1 .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.105e3 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 - 0.90e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 3 + 0.9e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .^ 2));
elseif i == 2
    
    K_ff = exp(logsigma) .* (-0.10e1 ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.250e1 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.500e0 .* bsxfun(@minus,t,s') .^ 4 ./ exp(logthetat) .^ 3 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.15e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,t,s') .^ 4 ./ exp(logthetat) .^ 3 + 0.15e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .^ 2 - zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.3e1 ./ 0.2e1) ./ exp(logthetat)) - alpha .* exp(logsigma) .* (-0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.500e0 ./ exp(logthetax) .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.1000e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.5000e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.105e3 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 + 0.15e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) + 0.15e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 - 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) - alpha .* (exp(logsigma) .* (0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.500e0 ./ exp(logthetax) .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.1000e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.5000e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.105e3 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 - 0.15e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) - 0.15e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') .^ 3 ./ exp(logthetat) .^ 2 + 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) - alpha .* exp(logsigma) .* (0.1500e1 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.30000e1 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,x,y') .^ 2 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.50000e0 .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.945e3 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.11e2 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.315e3 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + 0.45e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat)));
elseif i == 3
    
    K_ff = exp(logsigma) .* (0.50e0 ./ exp(logthetat) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.500e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .^ 2 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.15e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) .^ 2 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) + 0.3e1 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetat) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - alpha .* exp(logsigma) .* (-0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.2500e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.5000e0 .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.105e3 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,t,s') ./ exp(logthetat) + 0.75e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) - 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) - alpha .* (exp(logsigma) .* (0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.2500e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.5000e0 .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.105e3 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,t,s') ./ exp(logthetat) - 0.75e2 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) + 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) - alpha .* exp(logsigma) .* (-0.600e1 ./ exp(logthetax) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.19500e2 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,x,y') .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.70000e1 .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.50000e0 .* bsxfun(@minus,x,y') .^ 6 ./ exp(logthetax) .^ 5 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.945e3 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.11e2 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 6 ./ exp(logthetax) .^ 5 - 0.735e3 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 + 0.585e3 ./ 0.2e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 3 - 0.18e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .^ 2));
elseif i == 4
    
    K_ff =-exp(logsigma) .* (0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.1000e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.15e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) + 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) - exp(logsigma) .* (-0.100e1 ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.1000e1 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.15e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 2 .* bsxfun(@minus,t,s') ./ exp(logthetat) - 0.3e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .* bsxfun(@minus,t,s') ./ exp(logthetat)) + 0.2e1 .* alpha .* exp(logsigma) .* (0.300e1 ./ exp(logthetax) .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) - 0.6000e1 ./ exp(logthetax) .^ 3 .* bsxfun(@minus,x,y') .^ 2 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.10000e1 .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 .* exp(-0.5e0 .* bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) - 0.5e0 .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) + 0.105e3 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.9e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 4 ./ exp(logthetax) .^ 4 - 0.90e2 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.7e1 ./ 0.2e1) .* bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax) .^ 3 + 0.9e1 .* zeta .* (0.1e1 + bsxfun(@minus,t,s') .^ 2 ./ exp(logthetat) + bsxfun(@minus,x,y') .^ 2 ./ exp(logthetax)) .^ (-0.5e1 ./ 0.2e1) ./ exp(logthetax) .^ 2);
end

end

